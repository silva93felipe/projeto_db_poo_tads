package visao;

import java.util.ArrayList;
import java.util.InputMismatchException;
import java.util.Scanner;

import dominio.Consulta;
import dominio.DependenteUsuario;
import dominio.Medicamento;
import dominio.Medico;
import dominio.Usuario;
import persistencia.ConsultaDAO;
import persistencia.DependenteDAO;
import persistencia.MedicamentoDAO;
import persistencia.MedicoDAO;
import persistencia.UsuarioDAO;

public class Principal {

	public static void main(String[] args) {
		ArrayList<Usuario> users = new ArrayList<Usuario>();
		ArrayList<Medico> medicos = new ArrayList<Medico>();
		ArrayList<DependenteUsuario> dependentes = new ArrayList<DependenteUsuario>();
		ArrayList<Consulta> consultas = new ArrayList<Consulta>();
		ArrayList<Medicamento> medicamentos = new ArrayList<Medicamento>();
		
		//Objetos DAO
		MedicoDAO mDAO = new MedicoDAO();
		MedicamentoDAO medDAO = new MedicamentoDAO();
		UsuarioDAO userDAO = new UsuarioDAO();
		DependenteDAO depDAO = new DependenteDAO();
		ConsultaDAO conDAO = new ConsultaDAO();
		MedicamentoDAO medicamentoDAO = new MedicamentoDAO();
		
		//Variaveis auxiliares
		String cpfUserAux, cpfDepAux, cpfMedAux, codProdAux;
		
		Usuario user = new Usuario();
		DependenteUsuario dependente = new DependenteUsuario();
		Medico medico = new Medico();
		Consulta consulta = new Consulta();
		Medicamento medicamento = new Medicamento();
		
		
		int opcaoMenu, opcaoCli, opcaoMedico, opMedicament;
		
		Scanner teclado = new Scanner(System.in);
		
		do {
			System.out.println("\n------------------------------------");
			System.out.println("\n==========MENU PRINCIPAL============");
			System.out.println("\n------------------------------------");
			System.out.println("1 - CLIENTE");
			System.out.println("2 - MÉDICO");
			System.out.println("3 - MEDICAMENTOS");
			System.out.println("4 - SAIR");
			System.out.println("\n------------------------------------");
			
			opcaoMenu = teclado.nextInt();
			
			switch(opcaoMenu) {
				case 1:
					do {
						System.out.println("\n------------------------------------");
						System.out.println("\n=============CLIENTE================");
						System.out.println("\n------------------------------------");
						System.out.println(" 1 - CADASTRAR CLIENTE");
						System.out.println(" 2 - CADASTRAR DEPENDENTE");
						System.out.println(" 3 - MARCAR CONSULTA");   
						System.out.println(" 4 - CONSULTAS MARCADAS");
						System.out.println(" 5 - VOLTAR");
						System.out.println("\n------------------------------------");
						
						opcaoCli = teclado.nextInt();
						teclado.nextLine();
						
						switch(opcaoCli) { 
						
						case 1:
							
							System.out.println("Digite o CPF (Sem os pontos): ");
							
							cpfUserAux = teclado.nextLine();
							user = userDAO.buscarUsuario(cpfUserAux);
							
							if (user != null) {
								System.out.println("Ops, Usuario ja cadastrado.");
								break;
							}
							
							if(user == null) {
								user = new Usuario();
								
								user.setCpf(cpfUserAux);
								
								System.out.println("Digite o nome: ");
								user.setNome(teclado.nextLine());
								
								System.out.println("Digite a data de nascimento: ");
								user.setDataNasc(teclado.nextLine());
	
								System.out.println("Digite o sexo (M / F): ");
								user.setSexo(teclado.nextLine());
								
								System.out.println("Digite o email: ");
								user.setEmail(teclado.nextLine());
								
								System.out.println("Digite o telefone (Apenas numeros): ");
								user.setTelefone(teclado.nextLine());
								
								System.out.println("Digite o lagradouro: ");
								user.setLagradouro(teclado.nextLine());
								
								System.out.println("Digite o CEP (Apenas numeros): ");
								user.setCep(teclado.nextLine());
								
								System.out.println("Digite o nome do bairro: ");
								user.setBairro(teclado.nextLine());
								
								System.out.println("Digite o nome da cidade: ");
								user.setCidade(teclado.nextLine());
								
								System.out.println("Digite o nome do estado: ");
								user.setUF(teclado.nextLine());
								
								System.out.println("Digite o numero da casa:  ");
								user.setNumeroCasa(teclado.nextLine());
								
								userDAO.incluirUsuario(user);
								
								System.out.println("Cadastro realizado com sucesso.");
							}
							
							break;
	
						case 2:
							
							System.out.println("Digite o CPF do titular (Sem os pontos): ");
							cpfUserAux = teclado.nextLine();
							user = userDAO.buscarUsuario(cpfUserAux);
							
							if(user == null) {
								System.out.println("Titular não encontrado.");
								break;
							}
							
							System.out.println("Digite o CPF do dependente (Sem os pontos): ");
							cpfDepAux = teclado.nextLine();
							dependente = depDAO.bucarDependente(cpfDepAux);
							
							if(dependente != null) {
								System.out.println("Dependente já cadastrado.");
								break;
							}
								
							if (user != null && dependente == null) {
								System.out.println("Titular encontrado.");
								System.out.println("=============Informacoes do dependente================");
								dependente = new DependenteUsuario();
								
								dependente.setCpfTitular(cpfUserAux);
								
								dependente.setCpf(cpfDepAux);
		
								System.out.println("Digite o nome: ");
								dependente.setNome(teclado.nextLine());				
								
								System.out.println("Digite o sexo (M / F): ");
								dependente.setSexo(teclado.nextLine());
								
								System.out.println("Digite o email: ");
								dependente.setEmail(teclado.nextLine());
								
								System.out.println("Digite o telefone: ");
								dependente.setTelefone(teclado.nextLine());
								
								System.out.println("Digite a data de nascimento: ");
								dependente.setDataNasc(teclado.nextLine());
								
								depDAO.incluirDependente(dependente);
								
								System.out.println("Dependente cadastrado com sucesso.");
							}
							
							break;
						
						case 3:

							System.out.println("Digite o CPF do medico: ");
							cpfMedAux = teclado.nextLine();
							medico = mDAO.bucarMedico(cpfMedAux);
							
							if(medico == null) {
								System.out.println("Problema ao cadastrar a consulta, nem medico encontrado.");
								break;
							}
							
							System.out.println("Digite o CPF do usuario: ");
							cpfUserAux = teclado.nextLine();
							user = userDAO.buscarUsuario(cpfUserAux);
							
							// FAZER A PESQUISA NA TABELA DO DEPENDENTE
							
							if(user == null) {
								System.out.println("Problema ao cadastrar a consulta, nem cliente encontrado.");
								break;
							}
							consulta.setFKusuario(cpfUserAux);
							consulta.setFKmedico(cpfMedAux);
							
							System.out.println("Digite a data da consulta: ");
							consulta.setData(teclado.nextLine());
							
							System.out.println("Digite a hora da consulta: ");
							consulta.setHora(teclado.nextLine());

							System.out.println("Consulta marcada.");									
							
							break;
							
						case 4: 
							System.out.println("Digite o CPF do usuario: ");
							String consultaMarcada = teclado.nextLine();
							System.out.println("============Consultas============");
							
							for(int i = 0; i < consultas.size(); i++) {
								if(consultas.get(i).getFKusuario().equals(consultaMarcada)) {
									if(consultas.get(i).getStatus() == true) {
										System.out.println("Data " + consultas.get(i).getData() + " | " + "Hora " + consultas.get(i).getHora());										
									}
								}else {
									System.out.println("Nenhuma consulta marcada.");									
								}
							}
							
							System.out.println("================================");

							break;
						}
						
					}while(opcaoCli!=5);
				
				break;
				
				case 2:
					do {
						System.out.println("\n------------------------------------");
						System.out.println("\n=============MÉDICO=================");
						System.out.println("\n------------------------------------");
						System.out.println("1 - CADASTRAR");
						System.out.println("2 - AGENDA");
						System.out.println("3 - VOLTAR");
						System.out.println("\n------------------------------------");
						
						opcaoMedico = teclado.nextInt();
						teclado.nextLine();
						
						switch(opcaoMedico) {
						case 1:
							
							System.out.println("Digite o CPF do medico (Sem os pontos): ");
							cpfMedAux = teclado.nextLine();
							medico = mDAO.bucarMedico(cpfMedAux);
							
							if(medico != null) {
								System.out.println("Medico ja cadastrado.");
								break;
							}
							
							medico = new Medico();
						
							medico.setCpf(cpfMedAux);
							
							System.out.println("Digite o nome: ");
							medico.setNome(teclado.nextLine());				
														
							System.out.println("Digite o sexo (M / F): ");
							medico.setSexo(teclado.nextLine());
							
							System.out.println("Digite o email: ");
							medico.setEmail(teclado.nextLine());
							
							System.out.println("Digite o telefone: ");
							medico.setTelefone(teclado.nextLine());
							
							System.out.println("Digite a data de nascimento: ");
							medico.setDataNasc(teclado.nextLine());
							
							mDAO.incluirMedico(medico);
							
							System.out.println("Cadastrado com Sucesso.");
							
							break;
								
						case 2:
							System.out.println("Digite o CPF do medico (Sem os pontos): ");
							cpfMedAux = teclado.nextLine();
							consultas = conDAO.todasConsultasMedico(cpfMedAux);
							
							if(cpfMedAux == null) {
								System.out.println("Nenhuma consulta agendada.");
								break;
							}
							
							System.out.println("============Consultas============");
							for( int i=0; i < consultas.size(); i++){
		                        System.out.println("-------------------------------");
		                        System.out.println("DATA: " + consultas.get(i).getData());
		                        System.out.println("HORA: " + consultas.get(i).getHora());
		                    }
							
							System.out.println("================================");
							break;
						}
						
					}while(opcaoMedico!=3);
					
					break;
					
				case 3:
					
					do {
						System.out.println("\n------------------------------------");
						System.out.println("\n===========MEDICAMENTOS=============");
						System.out.println("\n------------------------------------");
						System.out.println("1 - CADASTRAR");
						System.out.println("2 - ESTOQUE");
						System.out.println("3 - SOLICITAR");
						System.out.println("4 - VOLTAR");
						System.out.println("\n------------------------------------");
						
						opMedicament = teclado.nextInt();
						teclado.nextLine();
						
						switch(opMedicament) {
							case 1:
								System.out.println("Digite codigo do produto: ");
								codProdAux = teclado.nextLine();
								medicamento = medicamentoDAO.bucarMedicamento(codProdAux);
								
								if(medicamento != null) {
									System.out.println("Ops, Medicamento ja cadastrado.");
									break;
								}
								
								medicamento.setIdProduto(codProdAux);
								
								System.out.println("Digite o nome do produto: ");
								medicamento.setDescricaProduto(teclado.nextLine());
								
								System.out.println("Digite a quantidade: ");
								medicamento.setQuantidade(teclado.nextInt());
								
								medDAO.incluirMedicamento(medicamento);
								System.out.println("Medicamento cadastrado com sucesso.");
								
								break;
							case 2:
								
								System.out.println("Digite codigo do produto: ");
								String codigoProd = teclado.nextLine();
								
								for(int i = 0; i < medicamentos.size(); i++) {
									if(medicamentos.get(i).getIdProduto().equals(codigoProd)){
										System.out.println("O saldo do produto " + medicamentos.get(i).getDescricaProduto() + 
												" eh: " + medicamentos.get(i).getQuantidade());
									}else {
										System.out.println("Produto nao encontrado.");
									}
								}
								
								break;
								
							case 3:
								System.out.println("Digite codigo do produto: ");
								String codigoProdReti = teclado.nextLine();
								
								for(int i = 0; i < medicamentos.size(); i++) {
									if(medicamentos.get(i).getIdProduto().equals(codigoProdReti)){
										System.out.println("Digite a quantidade: ");
										int quantidade = teclado.nextInt();
										teclado.nextLine();
										medicamentos.get(i).retirada(quantidade, codigoProdReti);
									}else {
										System.out.println("Produto nao encontrado.");
									}
								}
								
								break;
						}
						
					}while(opMedicament!=4);
					
					break;
				}
			
		}while(opcaoMenu!=4);
		
		System.out.println("Fim do programa...");
	 }

}

